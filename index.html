<html>
    <head>
        <title>COVID Red and Blue | COVID-19 Cases and Deaths by State Goverment Party Control</title>
        <link href='https://fonts.googleapis.com/css?family=Raleway:400,300,600' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css" integrity="sha512-EZLkOqwILORob+p0BXZc+Vm3RgJBOe1Iq/0fiI7r/wJgzOFZMlsqTa29UEl6v6U6gsV4uIpsNZoV32YZqrCRCQ==" crossorigin="anonymous" />
        <link rel="stylesheet" href="application.css" rel='stylesheet' type='text/css' x/>
    </head>
    <body>
        <div id="root"></div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"></script>
        <script src="https://unpkg.com/react@16.12.0/umd/react.development.js"></script>
        <script src="https://unpkg.com/react-dom@16.12.0/umd/react-dom.development.js"></script>
        <script src="https://unpkg.com/@babel/standalone@7.8.3/babel.js"></script>
        <script src="./data/us_records.json"></script>
        <script type="text/babel">
        const formatNumber = number => numeral(number).format('0,0');
        function StatesTable({showCasesOrDeaths, governmentBranch}) {
            const [statesData, setStatesData] = React.useState(US_RECORDS);
            const showOrHideCases = showCasesOrDeaths => ['cases','casesAndDeaths'].includes(showCasesOrDeaths) ? 'showCell' : 'hideCell';
            const showOrHideDeaths = showCasesOrDeaths => ['deaths','casesAndDeaths'].includes(showCasesOrDeaths) ? 'showCell' : 'hideCell';
            const colSpanCasesAndDeaths = showCasesOrDeaths => ['casesAndDeaths'].includes(showCasesOrDeaths) ? '2' : '1';
            const rowClassForPartyControl = (partyControl) => { 
                let className;
                if (partyControl == 'R')
                    className = 'rowRepublicanControl';
                else if (partyControl == 'D')
                    className = 'rowDemocratControl';
                else if (partyControl == 'S')
                    className = 'rowSplitControl'
                else
                    className = 'unknownControl'
                return className;
            }
            const statesRows = statesData.map((record) => { 
                return(
                    <tr key={record["State"]} className={rowClassForPartyControl(record["Control"])}>
                        <th className="stateName">{record["State"]}</th>
                        <td className={'colCellCases ' + showOrHideCases(showCasesOrDeaths)}>{formatNumber(record["NewCases"])}</td>
                        <td className={'colCellDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>{formatNumber(record["NewDeaths"])}</td>
                        <td className={'colCellCases ' + showOrHideCases(showCasesOrDeaths)}>{formatNumber(record["NewCases_prev6wk"])}</td>
                        <td className={'colCellDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>{formatNumber(record["NewDeaths_prev6wk"])}</td>
                        <td className={'colCellCases ' + showOrHideCases(showCasesOrDeaths)}>{formatNumber(record["NewCases_next6wk"])}</td>
                        <td className={'colCellDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>{formatNumber(record["NewDeaths_next6wk"])}</td>
                        <td className={'colCellCases ' + showOrHideCases(showCasesOrDeaths)}>{formatNumber(record["Cases"])}</td>
                        <td className={'colCellDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>{formatNumber(record["Deaths"])}</td>
                        <td className={'colCellCases ' + showOrHideCases(showCasesOrDeaths)}>{record["Cases_pctPop"]}</td>
                        <td className={'colCellDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>{record["Deaths_pctPop"]}</td>
                        <td className="colCellPopulation">{formatNumber(record["Population"])}</td>
                        <td>{record[governmentBranch]}</td>
                    </tr>); 
            });
            
            return (
                <table className="u-full-width">
                    <thead>
                        <tr>
                            <th rowSpan="2"></th>
                            <th className="colHeadsOne" colSpan={colSpanCasesAndDeaths(showCasesOrDeaths)}>Daily New</th>
                            <th className="colHeadsOne" colSpan={colSpanCasesAndDeaths(showCasesOrDeaths)}>Past 6 Weeks</th>
                            <th className="colHeadsOne" colSpan={colSpanCasesAndDeaths(showCasesOrDeaths)}>Next # Weeks</th>
                            <th className="colHeadsOne" colSpan={colSpanCasesAndDeaths(showCasesOrDeaths)}>Total</th>
                            <th className="colHeadsOne" colSpan={colSpanCasesAndDeaths(showCasesOrDeaths)}>% of Population</th>
                            <th className="colHeadsOne" rowSpan="2">Population</th>
                            <th rowSpan="2">{governmentBranch}</th>
                        </tr>
                        <tr>
                            <th className={'colHeadsCases ' + showOrHideCases(showCasesOrDeaths)}>Cases</th>
                            <th className={'colHeadsDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>Deaths</th>
                            <th className={'colHeadsCases ' + showOrHideCases(showCasesOrDeaths)}>Cases</th>
                            <th className={'colHeadsDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>Deaths</th>
                            <th className={'colHeadsCases ' + showOrHideCases(showCasesOrDeaths)}>Cases</th>
                            <th className={'colHeadsDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>Deaths</th>
                            <th className={'colHeadsCases ' + showOrHideCases(showCasesOrDeaths)}>Cases</th>
                            <th className={'colHeadsDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>Deaths</th>
                            <th className={'colHeadsCases ' + showOrHideCases(showCasesOrDeaths)}>Cases</th>
                            <th className={'colHeadsDeaths ' + showOrHideDeaths(showCasesOrDeaths)}>Deaths</th>
                        </tr>                      
                    </thead>
                    <tbody>
                        {statesRows}
                    </tbody>
                </table>
            )
        }
        function App () {

            const Heading1 = () => <h1>COVID <span style={{color: "red"}}>Red</span> and <span style={{color: "blue"}}>Blue</span></h1>;

            const [casesOrDeaths, setCasesOrDeaths] = React.useState('casesAndDeaths');
            const onChangeCasesOrDeaths = (event) => setCasesOrDeaths(event.target.value);
            const SelectCasesOrDeaths = () => {
                return(
                    <fieldset>
                        <label htmlFor="selectCasesAndDeaths">Show</label>
                        <select id="selectCasesAndDeaths" onChange={onChangeCasesOrDeaths} value={casesOrDeaths}>
                            <option value="casesAndDeaths">Cases and Deaths</option>
                            <option value="cases">Cases Only</option>
                            <option value="deaths">Deaths Only</option>
                        </select>
                    </fieldset>
                )
            }

            const [governmentBranch, setGovernmentBranch] = React.useState('Governor');
            const onChangeGovernmentBranch = (event) => setGovernmentBranch(event.target.value);
            const SelectGovernmentBranch = () => {
                return(
                    <fieldset>
                        <label htmlFor="SelectGovernmentBranch">by</label>
                        <select id="SelectGovernmentBranch" onChange={onChangeGovernmentBranch} value={governmentBranch}>
                            <option value="Governor">Governor&apos;s</option>
                            <option value="Legislature">State Legislature&apos;s</option>
                        </select> <label style={{float: 'right'}}>political party</label>
                    </fieldset>
                )
            }
            return (<><Heading1 /><SelectCasesOrDeaths /><SelectGovernmentBranch /><StatesTable showCasesOrDeaths={casesOrDeaths} governmentBranch={governmentBranch} /></>)
        }
        ReactDOM.render(<App />, document.getElementById('root'));
        </script>
    </body>
</html>